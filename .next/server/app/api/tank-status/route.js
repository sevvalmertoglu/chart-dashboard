(()=>{var e={};e.id=629,e.ids=[629],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},44810:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var a=r(56037),o=r.n(a);let n=new(o()).Schema({date:{type:Date,required:!0,get:e=>e.toISOString().split("T")[0]},sales_amount:{type:Number,required:!0},profit:{type:Number,required:!0},fuelType:{type:String,enum:["Diesel","Ad Blue","Super E5","Super E10"],required:!0},tankId:{type:String,required:!0},malfunctionCount:{type:Number,default:0},fill_rate:{type:Number,required:!0,min:0,max:100}},{timestamps:!0,toJSON:{getters:!0}});n.index({date:1});let s=o().models.Sale||o().model("Sale",n)},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},56037:e=>{"use strict";e.exports=require("mongoose")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},63276:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>v,routeModule:()=>d,serverHooks:()=>g,workAsyncStorage:()=>c,workUnitAsyncStorage:()=>m});var a={};r.r(a),r.d(a,{GET:()=>p});var o=r(96559),n=r(48088),s=r(37719),i=r(32190),u=r(97090),l=r(44810);async function p(e){try{await (0,u.A)();let{searchParams:t}=new URL(e.url),r=t.get("tankId")||"all",a=new Date("2023-01-01"),o=new Date("2024-12-31"),n=await l.A.aggregate([{$match:{date:{$gte:a,$lte:o},..."all"!==r?{tankId:r}:{}}},{$sort:{date:-1}},{$group:{_id:"$tankId",name:{$first:{$concat:["$tankId"]}},value:{$first:"$fill_rate"},lastUpdate:{$first:"$date"}}}]);return i.NextResponse.json(n)}catch(e){return console.error("Tank Status API Error:",e),i.NextResponse.json({error:"Tank durumu verileri alınırken bir hata oluştu"},{status:500})}}let d=new o.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/tank-status/route",pathname:"/api/tank-status",filename:"route",bundlePath:"app/api/tank-status/route"},resolvedPagePath:"/Users/sevvalmertoglu/Desktop/chart-dashboard/app/api/tank-status/route.ts",nextConfigOutput:"",userland:a}),{workAsyncStorage:c,workUnitAsyncStorage:m,serverHooks:g}=d;function v(){return(0,s.patchFetch)({workAsyncStorage:c,workUnitAsyncStorage:m})}},78335:()=>{},96487:()=>{},97090:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var a=r(56037),o=r.n(a);let n="mongodb+srv://sevvalmertoglu131:Rvs1KjO1IbX9WVGL@cluster0.7hsg4vx.mongodb.net/dashboard?retryWrites=true&w=majority&appName=Cluster0";if(!n)throw Error("MONGODB_URI is not defined in environment variables");let s=global.mongoose??{conn:null,promise:null},i=async function(){if(s.conn)return console.log("MongoDB bağlantısı zaten mevcut"),s.conn;s.promise||(console.log("MongoDB bağlantısı başlatılıyor..."),s.promise=o().connect(n,{bufferCommands:!0,maxPoolSize:10,serverSelectionTimeoutMS:5e3,socketTimeoutMS:45e3}).then(e=>(console.log("MongoDB bağlantısı başarılı!"),e.connection)).catch(e=>{throw console.error("MongoDB bağlantı hatası:",e),e}));try{return s.conn=await s.promise,global.mongoose=s,s.conn}catch(e){throw s.promise=null,e}}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[447,580],()=>r(63276));module.exports=a})();